<!doctype html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Chat App</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="https://cdn.jsdelivr.net/npm/node-forge@1.3.1/dist/forge.min.js"></script>
        <script>
            tailwind.config = {
                theme: {
                    extend: {
                        colors: {
                            primary: "#2b3990",
                            secondary: "#c6c705",
                        },
                    },
                },
            };
        </script>
    </head>
    <body class="bg-gray-100 h-screen flex items-center justify-center">
        <div
            class="bg-white rounded-lg shadow-lg w-full max-w-lg flex flex-col"
        >
            <div
                class="bg-primary text-white p-4 rounded-t-lg flex justify-between items-center"
            >
                <h1 class="text-lg font-bold">Chat App</h1>
                <div class="flex items-center space-x-2">
                    <div
                        id="status"
                        class="w-3 h-3 bg-red-500 rounded-full"
                    ></div>
                    <span id="statusText" class="text-sm">Disconnected</span>
                </div>
            </div>

            <!-- Login Form -->
            <div id="loginForm" class="p-4 space-y-4">
                <div>
                    <button
                        onclick="generateKeysAsync()"
                        id="connectBtn"
                        class="bg-secondary text-white font-semibold mt-2 p-2 rounded hover:bg-opacity-90"
                    >
                        Generate RSA Keys
                    </button>
                    <p class="italic text-sm text-red-500">
                        Before continuing to chat, you must generate RSA key
                        pair
                    </p>
                </div>

                <div>
                    <label class="block text-sm font-medium mb-1"
                        >Server URL:</label
                    >
                    <input
                        id="serverUrl"
                        type="text"
                        value="ws://localhost:8080/ws"
                        class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"
                    />
                </div>
                <div>
                    <label class="block text-sm font-medium mb-1">Token:</label>
                    <input
                        id="authToken"
                        type="text"
                        placeholder="Enter your token"
                        class="w-full p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"
                    />
                </div>

                <button
                    onclick="connect()"
                    id="connectBtn"
                    class="w-full bg-primary text-white py-2 rounded hover:bg-opacity-90"
                >
                    Connect
                </button>
                <div id="loginError" class="text-red-500 text-sm"></div>
            </div>

            <!-- Chat Container -->
            <div id="chatContainer" class="hidden flex flex-col h-96 h-full">
                <!-- Messages -->
                <div
                    id="messages"
                    class="flex-1 overflow-y-auto p-4 space-y-2 bg-gray-50"
                ></div>

                <!-- Input -->
                <div class="p-4 border-t bg-white">
                    <div class="flex space-x-2">
                        <input
                            id="messageInput"
                            type="text"
                            placeholder="Type a message..."
                            class="flex-1 p-2 border rounded focus:outline-none focus:ring-2 focus:ring-primary"
                            onkeypress="handleKeyPress(event)"
                        />
                        <button
                            onclick="sendMessage()"
                            class="bg-primary text-white px-4 py-2 rounded hover:bg-opacity-90"
                        >
                            Send
                        </button>
                    </div>
                </div>
            </div>
        </div>

        <script src="app.js"></script>
    </body>
</html>
